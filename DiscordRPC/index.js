import{store as g,intercept as u,currentMediaItem as y}from"@neptune";import{getMediaURLFromID as b}from"@neptune/utils";var c=[],n=t=>t.length>=128?t.slice(0,125)+"...":t,o=new WebSocket("ws://127.0.0.1:6463/?v=1&client_id=1130698654987067493");o.onopen=()=>{c.push(u("playbackControls/TIME_UPDATE",([t])=>{let i=g.getState(),{item:e,type:r}=y;if(r!="track")return;let l=b(e.album.cover),a=new Date,m=a.getTime()/1e3|0,d=a.setSeconds(a.getSeconds()+(e.duration-t)),s=i.playbackControls.playbackState=="NOT_PLAYING";o.send(JSON.stringify({cmd:"SET_ACTIVITY",args:{pid:2094112,activity:{timestamps:{...s?{}:{start:m,end:d}},type:2,name:n(e.title),details:n("by "+e.artists.map(p=>p.name).join(", ")),assets:{large_image:l,large_text:`on ${n(e.album.title)}`,...s?{small_image:"paused-icon",small_text:"Paused"}:{}}}}}))}))};async function _(){c.forEach(t=>t());try{o.close()}catch{}}export{_ as onUnload};
