import{store as g,intercept as u,currentMediaItem as y}from"@neptune";import{getMediaURLFromID as b}from"@neptune/utils";var i=[],o=t=>t.length>=128?t.slice(0,125)+"...":t,a=new WebSocket("ws://127.0.0.1:6463/?v=1&client_id=1130698654987067493");a.op;a.onopen=()=>{i.push(u("playbackControls/TIME_UPDATE",([t])=>{let c=g.getState(),{item:e,type:r}=y;if(r!="track")return;let l=b(e.album.cover),n=new Date,m=n.getTime()/1e3|0,d=n.setSeconds(n.getSeconds()+(e.duration-t)),s=c.playbackControls.playbackState=="NOT_PLAYING";a.send(JSON.stringify({cmd:"SET_ACTIVITY",args:{pid:2094112,activity:{timestamps:{...s?{}:{start:m,end:d}},type:2,name:o(e.title),details:o("by "+e.artists.map(p=>p.name).join(", ")),assets:{large_image:l,large_text:`on ${o(e.album.title)}`,...s?{small_image:"paused-icon",small_text:"Paused"}:{}}}}}))}))};async function _(){i.forEach(t=>t());try{a.close()}catch{}}export{_ as onUnload};
