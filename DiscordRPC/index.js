import{store as p,intercept as g,currentMediaItem as u}from"@neptune";import{getMediaURLFromID as y}from"@neptune/utils";var c=[],n=t=>t.length>=128?t.slice(0,125)+"...":t,o=new WebSocket("ws://127.0.0.1:6463/?v=1&client_id=1130698654987067493");o.onopen=()=>{c.push(g("playbackControls/TIME_UPDATE",([t])=>{let i=p.getState(),{item:e,type:r}=u;if(r!="track")return;let l=y(e.album.cover),a=new Date,b=a.getTime()/1e3|0,m=a.setSeconds(a.getSeconds()+(e.duration-t)),s=i.playbackControls.playbackState=="NOT_PLAYING";o.send(JSON.stringify({cmd:"SET_ACTIVITY",args:{pid:2094112,activity:{timestamps:{...s?{}:{end:m}},type:2,name:n(e.title),details:n("by "+e.artists.map(d=>d.name).join(", ")),assets:{large_image:l,large_text:`on ${n(e.album.title)}`,...s?{small_image:"paused-icon",small_text:"Paused"}:{}}}}}))}))};async function _(){c.forEach(t=>t());try{o.close()}catch{}}export{_ as onUnload};
