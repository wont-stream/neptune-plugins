import{store as g,intercept as y,currentMediaItem as u}from"@neptune";import{getMediaURLFromID as T}from"@neptune/utils";var s=[],o=t=>t.length>=128?t.slice(0,125)+"...":t,a=new WebSocket("ws://127.0.0.1:6463/?v=1&client_id=1130698654987067493");a.op;a.onopen=()=>{s.push(y("playbackControls/TIME_UPDATE",([t])=>{let c=g.getState(),{item:e,type:i}=u;if(i!="track")return;let r=T(e.album.cover),n=new Date,m=n.getTime()/1e3|0,l=n.setSeconds(n.getSeconds()+(e.duration-t)),p=c.playbackControls.playbackState=="NOT_PLAYING";a.send(JSON.stringify({cmd:"SET_ACTIVITY",args:{pid:2094112,activity:{...p?{smallImageKey:"paused-icon",smallImageText:"Paused"}:{startTimestamp:m,endTimestamp:l},type:2,name:o(e.title),details:o("by "+e.artists.map(d=>d.name).join(", ")),largeImageKey:r,largeImageText:`on ${o(e.album.title)}`}}}))}))};async function S(){s.forEach(t=>t());try{a.close()}catch{}}export{S as onUnload};
